{% extends "base.html" %}

{% block main_content %}
<section class="hero">
  <h2>‚öîÔ∏è Bienvenue dans l'ar√®ne des Morpions ‚öîÔ∏è</h2>
  <p>
    Composez vos √©quipes, exp√©rimentez des configurations de partie et surveillez leur performance.
    Cette page rassemble les statistiques principales n√©cessaires pour pr√©parer vos futures victoires.
  </p>
</section>

<section class="stats-cards">
  <h3>üìä Comptes instances (dev data)</h3>
  <div class="cards-grid">
    {% for compteur in REQUEST_VARS['stats']['counts'] %}
    <article class="card">
      <p class="card-label">{{ compteur.table|replace('_', ' ')|title }}</p>
      <p class="card-value">{{ compteur.count }}</p>
    </article>
    {% endfor %}
  </div>
</section>

<section class="top-teams">
  <h3>üèÜ Top {{ REQUEST_VARS['stats']['top_teams']|length }} √©quipes victorieuses</h3>
  {% if REQUEST_VARS['stats']['top_teams'] %}
  <table>
    <thead>
      <tr>
        <th>Rang</th>
        <th>√âquipe</th>
        <th>Victoires</th>
      </tr>
    </thead>
    <tbody>
      {% for team in REQUEST_VARS['stats']['top_teams'] %}
      <tr>
        <td>#{{ loop.index }}</td>
        <td><strong>{{ team.name }}</strong></td>
        <td>{{ team.wins }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">
    Aucun match termin√© n'a encore √©t√© enregistr√©.
  </p>
  {% endif %}
</section>

<section class="durations">
  <h3>‚è±Ô∏è Dur√©es des parties cl√¥tur√©es</h3>
  <ul>
    <li>
      <strong>Partie la plus rapide :</strong>
      {% if REQUEST_VARS['stats']['fastest_game'] %}
        <span style="color: var(--accent-cyan);">#{{ REQUEST_VARS['stats']['fastest_game']['id_game'] }}</span> ‚Äî 
        <span style="color: var(--accent-gold);">{{ REQUEST_VARS['stats']['fastest_game']['duration'] }}</span>
      {% else %}
        <span style="color: var(--text-secondary);">en attente de donn√©es.</span>
      {% endif %}
    </li>
    <li>
      <strong>Partie la plus longue :</strong>
      {% if REQUEST_VARS['stats']['longest_game'] %}
        <span style="color: var(--accent-cyan);">#{{ REQUEST_VARS['stats']['longest_game']['id_game'] }}</span> ‚Äî 
        <span style="color: var(--accent-gold);">{{ REQUEST_VARS['stats']['longest_game']['duration'] }}</span>
      {% else %}
        <span style="color: var(--text-secondary);">en attente de donn√©es.</span>
      {% endif %}
    </li>
  </ul>
</section>

<section class="logs">
  <h3>üìù Moyenne de lignes de journalisation par mois</h3>
  {% if REQUEST_VARS['stats']['avg_logs'] %}
  <table>
    <thead>
      <tr>
        <th>Ann√©e</th>
        <th>Mois</th>
        <th>Moyenne</th>
      </tr>
    </thead>
    <tbody>
      {% for row in REQUEST_VARS['stats']['avg_logs'] %}
      <tr>
        <td>{{ row.year }}</td>
        <td>{{ "%02d"|format(row.month) }}</td>
        <td><strong>{{ "%.2f"|format(row.avg_logs) }}</strong></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">
    Les journaux n'ont pas encore √©t√© g√©n√©r√©s.
  </p>
  {% endif %}
</section>

{% include 'message.html' %}
{% endblock %}
